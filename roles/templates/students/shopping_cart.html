{% extends "students/base.html" %}
<!-- -->
{% block title %} {{ block.super }} Shipping courses {% endblock title %}
<!-- -->
{% block css %} {{ block.super }}
<style>
  .popup {
    display: none;
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.35);
  }

  .popup-content {
    background-color: #fefefe;
    margin: 15% auto;
    padding: 20px;
    width: 80%;
    max-width: 500px;
    border-radius: 15px;
  }

  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
  }

  .close:hover,
  .close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
  }
</style>
{% endblock css %}
<!-- -->
<!-- -->
{% load static %}
<!-- -->
{% block content %}
<div id="popup" class="popup">
    <div class="popup-content">
        <span class="close">&times;</span>
        <h2>Installment Payment Option</h2>
        <p>
            Installment payment is available. Pay 20% of the total and pay the rest
      later.
        </p>
    </div>
</div>
<div class="mb4d25">
    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                {% for item in request.user.user_profile.get_all_cart_items %}
                <div class="fcrse_1 course_cart_object">
                    <a href="{{item.get_public_absolute_url}}" class="hf_img">
                        <img class="cart_img" src="{% if item.cover %}{{item.cover.url}}{% else %}{% static 'images/courses/img-2.jpg' %}{% endif %}" alt="">
                    </a>
                    <div class="hs_content">
                        <div class="eps_dots eps_dots10 more_dropdown">
                            <a role="button" data-remove-from-cart-url="{{item.get_remove_from_cart_url}}">
                                <i class="uil uil-times"></i>
                            </a>
                        </div>
                        <a href="{{item.get_public_absolute_url}}" class="crse14s title900 pt-2">
                            {{item.title}}
                        </a>
                        <a href="#" class="crse-cate">
                            {{item.sub_category.category.name|title}} |
              {{item.sub_category.name}}
                        </a
            >
                        <div class="auth1lnkprce">
                            <p class="cr1fot">
                                By
                                <a href="{{item.tutor.get_public_profile_url}}">{{item.tutor.full_name|title|default:item.tutor.user.username|title}}
                                </a
                >
                            </p>
                            <div class="prce142">${{item.payable_amount}}</div>
                        </div>
                    </div>
                </div>
                {% empty %}
                <div class="fcrse_1 course_empty_content">
                    <div class="hs_content">
                        <div class="py-4 px-5">
                            <div class="d-flex flex-column mx-auto align-items-center justify-content-center">
                                <button class="btn btn-primary btn-block">Empty cart!</button>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <div class="col-lg-4">
                <div class="membership_chk_bg rght1528">
                    <div class="checkout_title">
                        <h4>Total</h4>
                        <img src="{% static 'images/line.svg' %}" alt="">
                    </div>
                    {% if request.user.user_profile.get_all_cart_items %}
                    <form action="" method="post">
                        {% csrf_token %}
                        <div class="order_dt_section">
                            <div class="order_title">
                                <h4>Original Price</h4>
                                <div class="order_price">
                                    ${{profile.student_cart.total_price}}
                                </div>
                            </div>
                            <div class="order_title">
                                <h6>Discount Price</h6>
                                <div class="order_price">$0.00</div>
                            </div>
                            <div class="order_title">
                                <h2>Total</h2>
                                <div class="order_price5">
                                    ${{profile.student_cart.total_price}}
                                </div>
                            </div>
                            <div class="coupon_code">
                                <p>Learn now is applied.</p>
                                <div class="coupon_input">
                                    <div class="ui search focus mt-15">
                                        <div class="ui icon input swdh11 swdh19">
                                            <input
                                                class="prompt srch_explore"
                                                type="text"
                                                name="couponcode"
                                                value=""
                                                id="id_coupon_code"
                                                required=""
                                                maxlength="6"
                                                placeholder="Enter Coupon Code"
                                            >
                                        </div>
                                        <button class="code-apply-btn" type="submit">Apply</button>
                                    </div>
                                </div>
                            </div>
                            <a href="#" class="chck-btn22">Checkout Now</a>
                        </div>
                    </form>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock content %}
<!-- -->
{% block modal %}
<!-- -->
<!-- -->
{% endblock modal %} {% block scripts %}
<script>
  $(document).ready(function () {
    $(".eps_dots10.more_dropdown a[role='button']").on(
      "click",
      function (event) {
        event.preventDefault();
        const btn = $(this);
        const url = btn.data("remove-from-cart-url");
        console.log(event.target);
        console.log(btn);
        console.log(url);
        $.ajax({
          type: "POST",
          url: url,
          success: function (response) {
            console.log(response);
            $(".cart_counter").each(function(){
                $(this).text(parseInt(response.cart_count));
            });
            $(".order_dt_section").remove();
            $(".course_cart_object").each(function(){
                $(this).remove();
            });
            $(".course_empty_content").show();
          },
          error: function (xhr, status, error) {
            console.log(xhr.responseText);
          },
          complete: function () {},
        });
      }
    );
  });
  document.addEventListener("DOMContentLoaded", function () {
    var popup = document.getElementById("popup");
    var span = document.getElementsByClassName("close")[0];

    setTimeout(function () {
      popup.style.display = "block";
    }, 1000);

    span.onclick = function () {
      popup.style.display = "none";
    };

    window.onclick = function (event) {
      if (event.target == popup) {
        popup.style.display = "none";
      }
    };
  });
</script>
{% endblock scripts %}
